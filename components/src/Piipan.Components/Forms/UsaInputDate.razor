@using static FormConstants
@inherits UsaInputBase<DateTime?>
@inject IJSRuntime JSRuntime
@code {
    InputDate<DateTime?> InputDateReference { get; set; }
    public override int? Width { get; set; } = 180;
    private IJSObjectReference module;
    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            this.ElementReference = InputDateReference.Element;
            module = await JSRuntime.InvokeAsync<IJSObjectReference>("import", "./_content/Piipan.Components/Forms/UsaInputDate.razor.js");
        }

        await base.OnAfterRenderAsync(firstRender);
    }
    protected override async Task<List<string>> PreverificationChecks()
    {
        bool hasBadInput = await module.InvokeAsync<bool>("doesDateHaveBadInput", ElementReference);
        if (hasBadInput)
        {
            return new() { ValidationConstants.InvalidMessage };
        }
        else
        {
            return null;
        }
    }
}

<InputDate @ref="InputDateReference"
           class="@($"{InputClass} {(FormGroup.Status != InputStatus.None ? $"{InputClass}--{FormGroup.Status.ToString().ToLower()}" : "")}")"
           @bind-Value="CurrentValue" @onblur="BlurField"
           required="@FormGroup.Required"
           id="@($"{FormGroup?.GroupId}-input")"
           @attributes="AdditionalAttributes"
           style="@(Width != null ? $"width: {Width}px;" : "")">
</InputDate>