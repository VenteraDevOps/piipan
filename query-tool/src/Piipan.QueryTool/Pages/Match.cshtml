@page "{id?}"
@using Microsoft.AspNetCore.Antiforgery
@using Piipan.Match.Api.Models.Resolution
@using Piipan.States.Api.Models
@using Piipan.QueryTool.Client.Models
<link rel="stylesheet" href="app.css" type="text/css" />
@inject IAntiforgery antiforgery
@model Piipan.QueryTool.Pages.MatchModel
@{
    ViewData["Title"] = "NAC Participant Search";
}

@if (Model.Match != null)
{
    Model.InitializeUserState(); 
    <div class="grid-container">
        <component type="typeof(QueryTool.Client.Components.MatchDetail.MatchDetail)" render-mode="WebAssembly"
        param-Match="ParameterBase<MatchResApiResponse>.FromObject(Model.Match)"
        param-StateInfo="ParameterBase<StatesInfoResponse>.FromObject(Model.StateInfo)"
        param-LoggedInUsersState="Model.UserState"
        param-SaveResponse="Model.MatchDetailSaveResponse"
        param-Token="antiforgery.GetAndStoreTokens(HttpContext).RequestToken"/>
    </div>
}
else
{
    <div class="grid-container">
        <component type="typeof(QueryTool.Client.Components.MatchForm)" render-mode="WebAssembly"
            param-Query="Model.Query"
            param-QueryResult="ParameterBase<List<MatchResApiResponse>>.FromObject(Model.AvailableMatches)" 
            param-Token="antiforgery.GetAndStoreTokens(HttpContext).RequestToken"
            param-ServerErrors="Model.RequestErrors" />
    </div>
}
